# Auto-Discovery Demo Schema
#
# This schema demonstrates the auto_discover_columns feature which automatically
# queries ClickHouse system.columns to create property mappings.
#
# NOTE: This is a DEMO schema for testing the auto-discovery feature.
# The actual tables (users_bench, posts_bench with demo data) don't exist in the test database.
# To use this schema, you need to create these tables with appropriate columns.
#
# Status: Schema loading and API endpoints work correctly (Nov 18, 2025)
# Tests are marked as skipped until demo data is set up.

name: auto_discovery_demo

graph_schema:
  nodes:
    - label: User
      database: brahmand
      table: users_bench
      node_id: user_id
      
      # Enable auto-discovery: All columns become properties
      auto_discover_columns: true
      
      # Optional: Convert snake_case to camelCase
      naming_convention: camelCase
      
      # Exclude internal/system columns
      exclude_columns:
        - _shard_num
        - _version
      
      # Override specific property mappings
      property_mappings:
        full_name: name           # Rename full_name → name in Cypher
        email_address: email      # Rename email_address → email
        # All other columns use camelCase (e.g., user_id → userId)

    - label: Post
      database: brahmand
      table: posts_bench
      node_id: post_id
      
      # Auto-discover without exclusions
      auto_discover_columns: true
      
      # Simple rename
      property_mappings:
        post_content: content

  edges:
    - type: FOLLOWS
      database: brahmand
      table: user_follows_bench
      from_id: follower_id
      to_id: followed_id
      from_node: User
      to_node: User
      
      # Auto-discover relationship properties
      auto_discover_columns: true
      exclude_columns: [_internal_seq]
      property_mappings: {}  # Empty - identity mapping

    - type: LIKES
      database: brahmand
      table: post_likes_bench
      from_id: user_id
      to_id: post_id
      from_node: User
      to_node: Post
      
      # Auto-discover all columns
      auto_discover_columns: true
      property_mappings: {}  # Empty mappings - all identity
