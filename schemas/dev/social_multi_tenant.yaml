# Multi-tenant social network schema for db_multi_tenant
# Database: db_multi_tenant
# Setup: scripts/setup/setup_multi_tenant_data.sh
#
# Uses parameterized views with tenant_id for row-level isolation.
# Set tenant_id via session command before querying:
#   CALL sys.set('tenant_id', 'acme')
#
# Tenants: acme (users 1-3), globex (users 4-5)

name: social_multi_tenant

graph_schema:
  nodes:
    - label: User
      database: db_multi_tenant
      table: users_by_tenant
      node_id: user_id
      view_parameters: ["tenant_id"]
      property_mappings:
        user_id: user_id
        name: full_name
        email: email_address
        registration_date: registration_date
        is_active: is_active
        country: country
        city: city

    - label: Post
      database: db_multi_tenant
      table: posts_by_tenant
      node_id: post_id
      view_parameters: ["tenant_id"]
      property_mappings:
        post_id: post_id
        content: content
        date: created_at

  edges:
    - type: FOLLOWS
      database: db_multi_tenant
      table: follows_by_tenant
      from_id: follower_id
      to_id: followed_id
      from_node: User
      to_node: User
      view_parameters: ["tenant_id"]
      property_mappings:
        follow_date: follow_date

    - type: AUTHORED
      database: db_multi_tenant
      table: posts_by_tenant
      from_id: user_id
      to_id: post_id
      edge_id: post_id
      from_node: User
      to_node: Post
      view_parameters: ["tenant_id"]
      property_mappings: {}

    - type: LIKED
      database: db_multi_tenant
      table: likes_by_tenant
      from_id: user_id
      to_id: post_id
      from_node: User
      to_node: Post
      view_parameters: ["tenant_id"]
      property_mappings:
        like_date: liked_at
