# Denormalized flights schema for db_denormalized
# Database: db_denormalized
# Setup: scripts/setup/setup_denormalized_data.sh
#
# Denormalized pattern: Airport node properties (city, state) are embedded
# directly in the flights table. No separate Airport table exists.
# The flights table serves as BOTH the edge table AND the source of node properties.

name: flights_denormalized

graph_schema:
  nodes:
    - label: Airport
      database: db_denormalized
      table: flights_denorm
      node_id: code
      property_mappings: {}

      # Properties when Airport appears as origin (from_node)
      from_node_properties:
        code: origin_code
        city: origin_city
        state: origin_state

      # Properties when Airport appears as destination (to_node)
      to_node_properties:
        code: dest_code
        city: dest_city
        state: dest_state

  edges:
    - type: FLIGHT
      database: db_denormalized
      table: flights_denorm
      from_id: origin_code
      to_id: dest_code
      from_node: Airport
      to_node: Airport

      edge_id: [flight_id, flight_number]

      property_mappings:
        flight_id: flight_id
        flight_num: flight_number
        carrier: carrier
        departure_time: departure_time
        arrival_time: arrival_time
        distance: distance
