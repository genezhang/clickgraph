# LDBC SNB Interactive v1 Schema for ClickGraph
# Maps LDBC datagen output loaded into ClickHouse to a graph model
# Column names match ldbc/datagen-standalone output format

name: ldbc_snb

graph_schema:
  # ===========================================================================
  # NODES
  # ===========================================================================
  nodes:
    # -------------------------------------------------------------------------
    # Person - central node type in the social network
    # -------------------------------------------------------------------------
    - label: Person
      database: ldbc
      table: Person
      node_id: id
      property_mappings:
        id: id
        firstName: firstName
        lastName: lastName
        gender: gender
        birthday: birthday
        creationDate: creationDate
        locationIP: locationIP
        browserUsed: browserUsed
        language: language
        email: email

    # -------------------------------------------------------------------------
    # Post - content created by a Person in a Forum
    # -------------------------------------------------------------------------
    - label: Post
      database: ldbc
      table: Post
      node_id: id
      property_mappings:
        id: id
        imageFile: imageFile
        creationDate: creationDate
        locationIP: locationIP
        browserUsed: browserUsed
        language: language
        content: content
        length: length

    # -------------------------------------------------------------------------
    # Comment - reply to a Post or another Comment
    # -------------------------------------------------------------------------
    - label: Comment
      database: ldbc
      table: Comment
      node_id: id
      property_mappings:
        id: id
        creationDate: creationDate
        locationIP: locationIP
        browserUsed: browserUsed
        content: content
        length: length

    # -------------------------------------------------------------------------
    # Forum - container for Posts
    # -------------------------------------------------------------------------
    - label: Forum
      database: ldbc
      table: Forum
      node_id: id
      property_mappings:
        id: id
        title: title
        creationDate: creationDate

    # -------------------------------------------------------------------------
    # Tag - categorization for content
    # -------------------------------------------------------------------------
    - label: Tag
      database: ldbc
      table: Tag
      node_id: id
      property_mappings:
        id: id
        name: name
        url: url

    # -------------------------------------------------------------------------
    # TagClass - hierarchical classification of Tags
    # -------------------------------------------------------------------------
    - label: TagClass
      database: ldbc
      table: TagClass
      node_id: id
      property_mappings:
        id: id
        name: name
        url: url

    # -------------------------------------------------------------------------
    # Place - geographic location (City, Country, Continent)
    # -------------------------------------------------------------------------
    - label: Place
      database: ldbc
      table: Place
      node_id: id
      property_mappings:
        id: id
        name: name
        url: url
        type: type

    # -------------------------------------------------------------------------
    # Specific place types (using same table with type filter)
    # -------------------------------------------------------------------------
    - label: City
      database: ldbc
      table: Place
      node_id: id
      property_mappings:
        id: id
        name: name
        url: url

    - label: Country
      database: ldbc
      table: Place
      node_id: id
      property_mappings:
        id: id
        name: name
        url: url

    - label: Continent
      database: ldbc
      table: Place
      node_id: id
      property_mappings:
        id: id
        name: name
        url: url

    # -------------------------------------------------------------------------
    # Organisation - University or Company
    # -------------------------------------------------------------------------
    - label: Organisation
      database: ldbc
      table: Organisation
      node_id: id
      property_mappings:
        id: id
        name: name
        url: url
        type: type

    - label: University
      database: ldbc
      table: Organisation
      node_id: id
      property_mappings:
        id: id
        name: name
        url: url

    - label: Company
      database: ldbc
      table: Organisation
      node_id: id
      property_mappings:
        id: id
        name: name
        url: url

  # ===========================================================================
  # RELATIONSHIPS  
  # Note: Column names match datagen output (Person1Id, Person2Id, etc.)
  # ===========================================================================
  edges:
    # -------------------------------------------------------------------------
    # Person KNOWS Person (friendship, bidirectional)
    # Datagen columns: creationDate|Person1Id|Person2Id
    # -------------------------------------------------------------------------
    - type: KNOWS
      database: ldbc
      table: Person_knows_Person
      from_id: Person1Id
      to_id: Person2Id
      from_node: Person
      to_node: Person
      property_mappings:
        creationDate: creationDate

    # -------------------------------------------------------------------------
    # Person IS_LOCATED_IN City
    # Datagen columns: creationDate|PersonId|CityId
    # -------------------------------------------------------------------------
    - type: IS_LOCATED_IN
      database: ldbc
      table: Person_isLocatedIn_Place
      from_id: PersonId
      to_id: CityId
      from_node: Person
      to_node: City

    # -------------------------------------------------------------------------
    # Person HAS_INTEREST Tag
    # Datagen columns: creationDate|PersonId|TagId
    # -------------------------------------------------------------------------
    - type: HAS_INTEREST
      database: ldbc
      table: Person_hasInterest_Tag
      from_id: PersonId
      to_id: TagId
      from_node: Person
      to_node: Tag

    # -------------------------------------------------------------------------
    # Person STUDY_AT University
    # Datagen columns: creationDate|PersonId|UniversityId|classYear
    # -------------------------------------------------------------------------
    - type: STUDY_AT
      database: ldbc
      table: Person_studyAt_Organisation
      from_id: PersonId
      to_id: UniversityId
      from_node: Person
      to_node: University
      property_mappings:
        classYear: classYear
        creationDate: creationDate

    # -------------------------------------------------------------------------
    # Person WORK_AT Company
    # Datagen columns: creationDate|PersonId|CompanyId|workFrom
    # -------------------------------------------------------------------------
    - type: WORK_AT
      database: ldbc
      table: Person_workAt_Organisation
      from_id: PersonId
      to_id: CompanyId
      from_node: Person
      to_node: Company
      property_mappings:
        workFrom: workFrom
        creationDate: creationDate

    # -------------------------------------------------------------------------
    # Person LIKES Post
    # Datagen columns: creationDate|PersonId|PostId
    # -------------------------------------------------------------------------
    - type: LIKES
      database: ldbc
      table: Person_likes_Post
      from_id: PersonId
      to_id: PostId
      from_node: Person
      to_node: Post
      property_mappings:
        creationDate: creationDate

    # -------------------------------------------------------------------------
    # Person LIKES Comment
    # Datagen columns: creationDate|PersonId|CommentId
    # -------------------------------------------------------------------------
    - type: LIKES_COMMENT
      database: ldbc
      table: Person_likes_Comment
      from_id: PersonId
      to_id: CommentId
      from_node: Person
      to_node: Comment
      property_mappings:
        creationDate: creationDate

    # -------------------------------------------------------------------------
    # Forum HAS_MODERATOR Person
    # Datagen columns: creationDate|ForumId|PersonId
    # -------------------------------------------------------------------------
    - type: HAS_MODERATOR
      database: ldbc
      table: Forum_hasModerator_Person
      from_id: ForumId
      to_id: PersonId
      from_node: Forum
      to_node: Person

    # -------------------------------------------------------------------------
    # Forum HAS_MEMBER Person
    # Datagen columns: creationDate|ForumId|PersonId
    # -------------------------------------------------------------------------
    - type: HAS_MEMBER
      database: ldbc
      table: Forum_hasMember_Person
      from_id: ForumId
      to_id: PersonId
      from_node: Forum
      to_node: Person
      property_mappings:
        creationDate: creationDate

    # -------------------------------------------------------------------------
    # Forum HAS_TAG Tag
    # Datagen columns: creationDate|ForumId|TagId
    # -------------------------------------------------------------------------
    - type: HAS_TAG
      database: ldbc
      table: Forum_hasTag_Tag
      from_id: ForumId
      to_id: TagId
      from_node: Forum
      to_node: Tag

    # -------------------------------------------------------------------------
    # Forum CONTAINER_OF Post
    # Datagen columns: creationDate|ForumId|PostId
    # -------------------------------------------------------------------------
    - type: CONTAINER_OF
      database: ldbc
      table: Forum_containerOf_Post
      from_id: ForumId
      to_id: PostId
      from_node: Forum
      to_node: Post

    # -------------------------------------------------------------------------
    # Post HAS_CREATOR Person
    # Datagen columns: creationDate|PostId|PersonId
    # -------------------------------------------------------------------------
    - type: HAS_CREATOR
      database: ldbc
      table: Post_hasCreator_Person
      from_id: PostId
      to_id: PersonId
      from_node: Post
      to_node: Person

    # -------------------------------------------------------------------------
    # Post IS_LOCATED_IN Country
    # Datagen columns: creationDate|PostId|CountryId
    # -------------------------------------------------------------------------
    - type: POST_LOCATED_IN
      database: ldbc
      table: Post_isLocatedIn_Place
      from_id: PostId
      to_id: CountryId
      from_node: Post
      to_node: Country

    # -------------------------------------------------------------------------
    # Post HAS_TAG Tag
    # Datagen columns: creationDate|PostId|TagId
    # -------------------------------------------------------------------------
    - type: POST_HAS_TAG
      database: ldbc
      table: Post_hasTag_Tag
      from_id: PostId
      to_id: TagId
      from_node: Post
      to_node: Tag

    # -------------------------------------------------------------------------
    # Comment HAS_CREATOR Person
    # Datagen columns: creationDate|CommentId|PersonId
    # -------------------------------------------------------------------------
    - type: COMMENT_CREATOR
      database: ldbc
      table: Comment_hasCreator_Person
      from_id: CommentId
      to_id: PersonId
      from_node: Comment
      to_node: Person

    # -------------------------------------------------------------------------
    # Comment IS_LOCATED_IN Country
    # Datagen columns: creationDate|CommentId|CountryId
    # -------------------------------------------------------------------------
    - type: COMMENT_LOCATED_IN
      database: ldbc
      table: Comment_isLocatedIn_Place
      from_id: CommentId
      to_id: CountryId
      from_node: Comment
      to_node: Country

    # -------------------------------------------------------------------------
    # Comment HAS_TAG Tag
    # Datagen columns: creationDate|CommentId|TagId
    # -------------------------------------------------------------------------
    - type: COMMENT_HAS_TAG
      database: ldbc
      table: Comment_hasTag_Tag
      from_id: CommentId
      to_id: TagId
      from_node: Comment
      to_node: Tag

    # -------------------------------------------------------------------------
    # Comment REPLY_OF Post
    # Datagen columns: creationDate|CommentId|PostId
    # -------------------------------------------------------------------------
    - type: REPLY_OF_POST
      database: ldbc
      table: Comment_replyOf_Post
      from_id: CommentId
      to_id: PostId
      from_node: Comment
      to_node: Post

    # -------------------------------------------------------------------------
    # Comment REPLY_OF Comment
    # Datagen columns: creationDate|Comment1Id|Comment2Id
    # -------------------------------------------------------------------------
    - type: REPLY_OF_COMMENT
      database: ldbc
      table: Comment_replyOf_Comment
      from_id: Comment1Id
      to_id: Comment2Id
      from_node: Comment
      to_node: Comment

    # -------------------------------------------------------------------------
    # Tag HAS_TYPE TagClass
    # Datagen columns: TagId|TagClassId
    # -------------------------------------------------------------------------
    - type: HAS_TYPE
      database: ldbc
      table: Tag_hasType_TagClass
      from_id: TagId
      to_id: TagClassId
      from_node: Tag
      to_node: TagClass

    # -------------------------------------------------------------------------
    # TagClass IS_SUBCLASS_OF TagClass
    # Datagen columns: TagClass1Id|TagClass2Id
    # -------------------------------------------------------------------------
    - type: IS_SUBCLASS_OF
      database: ldbc
      table: TagClass_isSubclassOf_TagClass
      from_id: TagClass1Id
      to_id: TagClass2Id
      from_node: TagClass
      to_node: TagClass

    # -------------------------------------------------------------------------
    # Place IS_PART_OF Place
    # Datagen columns: Place1Id|Place2Id
    # -------------------------------------------------------------------------
    - type: IS_PART_OF
      database: ldbc
      table: Place_isPartOf_Place
      from_id: Place1Id
      to_id: Place2Id
      from_node: Place
      to_node: Place

    # -------------------------------------------------------------------------
    # Organisation IS_LOCATED_IN Place
    # Datagen columns: OrganisationId|PlaceId
    # -------------------------------------------------------------------------
    - type: ORG_LOCATED_IN
      database: ldbc
      table: Organisation_isLocatedIn_Place
      from_id: OrganisationId
      to_id: PlaceId
      from_node: Organisation
      to_node: Place
